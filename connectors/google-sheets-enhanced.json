{
  "id": "google-sheets-enhanced",
  "name": "Google Sheets Enhanced",
  "description": "Enhanced Google Sheets with advanced spreadsheet operations",
  "category": "Productivity",
  "icon": "table",
  "color": "#34A853",
  "version": "1.0.0",
  "authentication": {
    "type": "oauth2",
    "config": {
      "authUrl": "https://accounts.google.com/o/oauth2/auth",
      "tokenUrl": "https://oauth2.googleapis.com/token",
      "scopes": [
        "https://www.googleapis.com/auth/spreadsheets",
        "https://www.googleapis.com/auth/drive.metadata.readonly"
      ]
    }
  },
  "baseUrl": "https://sheets.googleapis.com/v4",
  "rateLimits": {
    "requestsPerSecond": 10,
    "requestsPerMinute": 600,
    "dailyLimit": 1000000
  },
  "actions": [
    {
      "id": "test_connection",
      "name": "Test Connection",
      "description": "Test the connection to Google Sheets Enhanced and verify authentication",
      "parameters": {
        "type": "object",
        "properties": {},
        "required": [],
        "additionalProperties": false
      }
    },
    {
      "id": "append_row",
      "name": "Append Row",
      "description": "Append a row to a sheet",
      "parameters": {
        "type": "object",
        "properties": {
          "spreadsheetId": {
            "type": "string",
            "description": "Spreadsheet ID"
          },
          "sheet": {
            "type": "string",
            "description": "Sheet name or range (e.g., 'Sheet1' or 'Sheet1!A1:C1')"
          },
          "values": {
            "type": "array",
            "items": {"type": "string"},
            "description": "Array of cell values to append"
          },
          "valueInputOption": {
            "type": "string",
            "enum": ["RAW", "USER_ENTERED"],
            "default": "USER_ENTERED",
            "description": "How values should be interpreted"
          }
        },
        "required": ["spreadsheetId", "sheet", "values"],
        "additionalProperties": false
      }
    },
    {
      "id": "update_cell",
      "name": "Update Cell",
      "description": "Update a specific cell value",
      "parameters": {
        "type": "object",
        "properties": {
          "spreadsheetId": {
            "type": "string",
            "description": "Spreadsheet ID"
          },
          "range": {
            "type": "string",
            "description": "Cell range (e.g., 'Sheet1!A1' or 'A1')"
          },
          "value": {
            "type": "string",
            "description": "Cell value to set"
          },
          "valueInputOption": {
            "type": "string",
            "enum": ["RAW", "USER_ENTERED"],
            "default": "USER_ENTERED",
            "description": "How values should be interpreted"
          }
        },
        "required": ["spreadsheetId", "range", "value"],
        "additionalProperties": false
      }
    },
    {
      "id": "update_range",
      "name": "Update Range",
      "description": "Update a range of cells",
      "parameters": {
        "type": "object",
        "properties": {
          "spreadsheetId": {
            "type": "string",
            "description": "Spreadsheet ID"
          },
          "range": {
            "type": "string",
            "description": "Cell range (e.g., 'Sheet1!A1:C3')"
          },
          "values": {
            "type": "array",
            "items": {
              "type": "array",
              "items": {"type": "string"}
            },
            "description": "2D array of cell values"
          },
          "valueInputOption": {
            "type": "string",
            "enum": ["RAW", "USER_ENTERED"],
            "default": "USER_ENTERED",
            "description": "How values should be interpreted"
          }
        },
        "required": ["spreadsheetId", "range", "values"],
        "additionalProperties": false
      }
    },
    {
      "id": "get_values",
      "name": "Get Values",
      "description": "Get values from a range of cells",
      "parameters": {
        "type": "object",
        "properties": {
          "spreadsheetId": {
            "type": "string",
            "description": "Spreadsheet ID"
          },
          "range": {
            "type": "string",
            "description": "Cell range (e.g., 'Sheet1!A1:C10')"
          },
          "valueRenderOption": {
            "type": "string",
            "enum": ["FORMATTED_VALUE", "UNFORMATTED_VALUE", "FORMULA"],
            "default": "FORMATTED_VALUE",
            "description": "How values should be rendered"
          },
          "dateTimeRenderOption": {
            "type": "string",
            "enum": ["SERIAL_NUMBER", "FORMATTED_STRING"],
            "default": "FORMATTED_STRING",
            "description": "How dates and times should be rendered"
          }
        },
        "required": ["spreadsheetId", "range"],
        "additionalProperties": false
      }
    },
    {
      "id": "clear_range",
      "name": "Clear Range",
      "description": "Clear values from a range of cells",
      "parameters": {
        "type": "object",
        "properties": {
          "spreadsheetId": {
            "type": "string",
            "description": "Spreadsheet ID"
          },
          "range": {
            "type": "string",
            "description": "Cell range to clear (e.g., 'Sheet1!A1:C10')"
          }
        },
        "required": ["spreadsheetId", "range"],
        "additionalProperties": false
      }
    },
    {
      "id": "create_sheet",
      "name": "Create Sheet",
      "description": "Create a new sheet in the spreadsheet",
      "parameters": {
        "type": "object",
        "properties": {
          "spreadsheetId": {
            "type": "string",
            "description": "Spreadsheet ID"
          },
          "title": {
            "type": "string",
            "description": "Sheet title"
          },
          "index": {
            "type": "number",
            "description": "Position index for the sheet"
          },
          "gridProperties": {
            "type": "object",
            "properties": {
              "rowCount": {"type": "number"},
              "columnCount": {"type": "number"}
            },
            "description": "Grid properties for the sheet"
          }
        },
        "required": ["spreadsheetId", "title"],
        "additionalProperties": false
      }
    },
    {
      "id": "delete_sheet",
      "name": "Delete Sheet",
      "description": "Delete a sheet from the spreadsheet",
      "parameters": {
        "type": "object",
        "properties": {
          "spreadsheetId": {
            "type": "string",
            "description": "Spreadsheet ID"
          },
          "sheetId": {
            "type": "number",
            "description": "Sheet ID to delete"
          }
        },
        "required": ["spreadsheetId", "sheetId"],
        "additionalProperties": false
      }
    },
    {
      "id": "duplicate_sheet",
      "name": "Duplicate Sheet",
      "description": "Duplicate an existing sheet",
      "parameters": {
        "type": "object",
        "properties": {
          "spreadsheetId": {
            "type": "string",
            "description": "Spreadsheet ID"
          },
          "sourceSheetId": {
            "type": "number",
            "description": "ID of the sheet to duplicate"
          },
          "newSheetName": {
            "type": "string",
            "description": "Name for the new duplicated sheet"
          }
        },
        "required": ["spreadsheetId", "sourceSheetId"],
        "additionalProperties": false
      }
    },
    {
      "id": "format_cells",
      "name": "Format Cells",
      "description": "Apply formatting to a range of cells",
      "parameters": {
        "type": "object",
        "properties": {
          "spreadsheetId": {
            "type": "string",
            "description": "Spreadsheet ID"
          },
          "range": {
            "type": "string",
            "description": "Cell range to format"
          },
          "format": {
            "type": "object",
            "properties": {
              "backgroundColor": {"type": "object"},
              "textFormat": {"type": "object"},
              "numberFormat": {"type": "object"},
              "borders": {"type": "object"}
            },
            "description": "Format properties to apply"
          }
        },
        "required": ["spreadsheetId", "range", "format"],
        "additionalProperties": false
      }
    },
    {
      "id": "find_replace",
      "name": "Find and Replace",
      "description": "Find and replace text in the spreadsheet",
      "parameters": {
        "type": "object",
        "properties": {
          "spreadsheetId": {
            "type": "string",
            "description": "Spreadsheet ID"
          },
          "find": {
            "type": "string",
            "description": "Text to find"
          },
          "replacement": {
            "type": "string",
            "description": "Replacement text"
          },
          "sheetId": {
            "type": "number",
            "description": "Specific sheet ID to search in (optional)"
          },
          "allSheets": {
            "type": "boolean",
            "default": true,
            "description": "Search in all sheets"
          },
          "matchCase": {
            "type": "boolean",
            "default": false,
            "description": "Match case sensitivity"
          },
          "matchEntireCell": {
            "type": "boolean",
            "default": false,
            "description": "Match entire cell content"
          }
        },
        "required": ["spreadsheetId", "find", "replacement"],
        "additionalProperties": false
      }
    },
    {
      "id": "sort_range",
      "name": "Sort Range",
      "description": "Sort a range of cells",
      "parameters": {
        "type": "object",
        "properties": {
          "spreadsheetId": {
            "type": "string",
            "description": "Spreadsheet ID"
          },
          "range": {
            "type": "string",
            "description": "Range to sort"
          },
          "sortSpecs": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "dimensionIndex": {"type": "number"},
                "sortOrder": {"type": "string", "enum": ["ASCENDING", "DESCENDING"]}
              }
            },
            "description": "Sort specifications"
          }
        },
        "required": ["spreadsheetId", "range", "sortSpecs"],
        "additionalProperties": false
      }
    }
  ],
  "triggers": [
    {
      "id": "row_added",
      "name": "Row Added",
      "description": "Triggered when a new row is added",
      "type": "webhook",
      "parameters": {
        "type": "object",
        "properties": {
          "spreadsheetId": {
            "type": "string",
            "description": "Spreadsheet ID to monitor"
          },
          "sheetName": {
            "type": "string",
            "description": "Specific sheet name to monitor"
          }
        },
        "required": ["spreadsheetId"],
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "rowIndex": {"type": "number"},
          "values": {"type": "array", "items": {"type": "string"}},
          "sheetName": {"type": "string"},
          "spreadsheetId": {"type": "string"}
        }
      }
    },
    {
      "id": "cell_updated",
      "name": "Cell Updated",
      "description": "Triggered when a cell value is updated",
      "type": "webhook",
      "parameters": {
        "type": "object",
        "properties": {
          "spreadsheetId": {
            "type": "string",
            "description": "Spreadsheet ID to monitor"
          },
          "range": {
            "type": "string",
            "description": "Specific range to monitor (optional)"
          }
        },
        "required": ["spreadsheetId"],
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "range": {"type": "string"},
          "oldValue": {"type": "string"},
          "newValue": {"type": "string"},
          "sheetName": {"type": "string"},
          "spreadsheetId": {"type": "string"}
        }
      }
    }
  ],
  "testConnection": {
    "method": "GET",
    "endpoint": "/spreadsheets"
  }
}